<!DOCTYPE html>
<!-- saved from url=(0066)https://learning.kynaforkids.vn/manage-exchange-learning-data.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>KynaForKids</title>
</head>

<body>

<div id="root"></div>
<script>
  let landingPageConfig = {
    domain: window.location.origin,
    mediaLink: 'http://localhost:63342/kynaforkids-landing-page',
    apiBaseUrl: 'http://api.kynaforkids.local/v1',
    linkVisitor: 'http://localhost:3000',
    gtmId: 'GTM-TKXN2P8',
    linkLearning: 'http://localhost:3001',
    selectEnvironment: function () {
      switch (this.domain) {
        case 'https://dev.kynaforkids.vn':
          this.mediaLink = 'https://media-dev.kynaforkids.vn'
          this.apiBaseUrl = 'https://api-dev.kynaforkids.vn/v1'
          this.linkVisitor = 'https://dev.kynaforkids.vn'
          this.linkLearning = 'https://learning-dev.kynaforkids.vn'
          this.gtmId = 'GTM-TKXN2P8'
          break
        case 'https://staging.kynaforkids.vn':
          this.mesdiaLink = 'https://media-staging.kynaforkids.vn/assets/khoa-hoc'
          this.apiBaseUrl = 'https://api-staging.kynaforkids.vn/v1'
          this.linkVisitor = 'https://staging.kynaforkids.vn'
          this.linkLearning = 'https://learning-staging.kynaforkids.vn'
          this.gtmId = 'GTM-TKXN2P8'
          break
        case 'https://kynaforkids.vn':
          this.mediaLink = 'https://media-kynaforkids.cdn.vccloud.vn/assets/khoa-hoc'
          this.apiBaseUrl = 'https://api.kynaforkids.vn/v1'
          this.linkVisitor = 'https://kynaforkids.vn'
          this.linkLearning = 'https://learning.kynaforkids.vn'
          this.gtmId = 'GTM-TKXN2P8'
          break
      }
    }
  }
  landingPageConfig.selectEnvironment()
  var storageConstants = {
    CURRENT_AFFILIATE_ID: 'current_affiliate_id',
    USER: 'user',
    ACTIVE_COD: 'active_cod',
    CHILDREN: 'children',
  }
  var storageServices = {
    remove: function (key) {
      localStorage.removeItem(key)
    },
    set: function (key, data) {
      localStorage.setItem(key, data)
    },
    get: function (key) {
      return localStorage.getItem(key)
    }
  }
  var exChangeActions = {
    receiveMessage: function (e) {
      if (!e.isTrusted) {
        return
      }
      let dataType = e.data.type
      if (e.data !== '' && dataType !== 'INIT_INSTANCE' && dataType !== 'STOP' && dataType !== 'START' &&
        dataType !== 'STATE' && e.data.reactBuildType !== 'development') {
        var payload = JSON.parse(e.data)
        exChangeActions.handleReceivceMessage(payload.key, payload.method, payload.data)
      }
    },
    handleReceivceMessage: function (key, method, data) {
      switch (key) {
        case 'user':
          exChangeActions.handleUser(method, data)
          break
        case 'children':
          exChangeActions.handleChildren(method, data)
          break
        case 'affiliate':
          exChangeActions.handleAffiliate(method, data)
          break
        case storageConstants.ACTIVE_COD:
          exChangeActions.handleActiveCod(method, data)
          break
        default:
          break
      }
    },
    handleUser: function (method, data) {
      if (method === 'remove') {
        storageServices.remove(storageConstants.USER)
      } else if (method === 'save') {
        storageServices.set(storageConstants.USER, JSON.stringify(data))
      }
    },
    handleChildren: function (method, data) {
      if (method === 'remove') {
        storageServices.remove(storageConstants.CHILDREN)
      } else if (method === 'save') {
        storageServices.set(storageConstants.CHILDREN, JSON.stringify(data))
      }
    },
    handleAffiliate: function (method, data) {
      if (method === 'remove') {
        storageServices.remove(storageConstants.CURRENT_AFFILIATE_ID)
      } else if (method === 'save') {
        storageServices.set(storageConstants.CURRENT_AFFILIATE_ID, data)
      }
    },
    handleActiveCod (method, data) {
      if (method === 'save') {
        storageServices.set(storageConstants.ACTIVE_COD, data)
      }
    },
  }
  window.addEventListener('message', exChangeActions.receiveMessage, false)
</script>



</body></html>